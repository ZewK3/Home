# Cloudflare Pages Deployment Guide

This React application is optimized for **automatic build and deployment** on Cloudflare Pages.

## 🚀 Automatic Deployment Setup

### 1. Connect Repository to Cloudflare Pages

1. Go to [Cloudflare Dashboard](https://dash.cloudflare.com/) → Pages
2. Click "Create a project" → "Connect to Git"
3. Select your GitHub repository `ZewK3/Home`
4. Configure build settings:

```
Framework preset: Vite
Build command: npm run build
Build output directory: dist
Root directory: (leave empty for root deployment)
Node.js version: 20
```

⚠️ **Important**: Cloudflare will automatically:
- Install dependencies (`npm install`)
- Run the build command (`npm run build`) 
- Deploy the `dist/` directory contents
- **NOT** deploy source files

### 2. Build Process Details

**What happens during Cloudflare deployment:**
```bash
# 1. Cloudflare installs dependencies
npm install

# 2. Cloudflare runs the build command
npm run build
# → Creates dist/ directory with optimized files
# → Copies _redirects and _headers from public/ to dist/

# 3. Cloudflare deploys only the dist/ directory
# ✅ Serves: dist/index.html → /assets/index-[hash].js (bundled)
# ❌ Never serves: src/main.jsx (source files)
```

## 📁 File Structure

```
Home/                   ← Source code (not deployed)
├── src/               ← React components (not deployed)  
├── public/            ← Static files (copied to dist/)
│   ├── _redirects     ← SPA routing config
│   └── _headers       ← Security headers
├── package.json       ← Build configuration
├── vite.config.js     ← Vite bundler config
└── dist/              ← Generated by build (this gets deployed)
    ├── index.html     ← Entry point with bundled assets
    ├── assets/        ← Optimized JS/CSS bundles
    ├── _redirects     ← Copied from public/
    └── _headers       ← Copied from public/
```

## ✅ Configured Features

### SPA Routing Support
- `_redirects` file: `/*    /index.html   200`
- All routes redirect to React Router

### Security & Performance Headers  
- Content Security Policy
- MIME type fixes for JS modules
- Asset caching (1 year static, 1 hour HTML)

### Build Optimization
- Code splitting and minification
- Asset hashing for cache busting
- React production builds

## 🔧 Local Development

```bash
# Install dependencies
npm install

# Start development server (localhost:3000)
npm run dev

# Build for production (test Cloudflare build locally)
npm run build

# Preview production build
npm run preview
```

## 🌐 Deployment URL

After deployment, your app will be available at:
- `https://your-project-name.pages.dev`
- Custom domain (if configured)

## 🛠️ Troubleshooting

### "MIME type of text/jsx" Error

This error means Cloudflare is serving source files instead of built files:

**Solution:**
1. **Check build output directory**: Must be `dist` in Cloudflare settings
2. **Verify build command**: Should be `npm run build` (not `npm run dev`)
3. **Check deployment logs**: Ensure build completed successfully
4. **Force redeploy**: Push a change or retry deployment

### Build Verification

Run locally to test the build process:
```bash
npm run build
npm run verify  # Check if assets are correct
```

Built files should reference `/assets/index-[hash].js`, not `/src/main.jsx`.

## 🔄 Migration Notes

This project was optimized for Cloudflare Pages with:
- ✅ Simplified build command (removed manual file copying)
- ✅ Vite automatic public file copying
- ✅ Root-level deployment configuration  
- ✅ Cloudflare-specific routing and headers