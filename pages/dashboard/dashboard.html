<!DOCTYPE html>
<html lang="vi" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Hệ thống quản lý nhân sự chuyên nghiệp">
    <meta name="theme-color" content="#2563eb">
    <link rel="icon" href="../../assets/icons/favicon-32x32.png" sizes="32x32">
    <title>HR Management System - Dashboard</title>
    
    <!-- Modular CSS Files -->
    <link rel="stylesheet" href="../../assets/css/base.css">
    <link rel="stylesheet" href="../../assets/css/components.css">
    <link rel="stylesheet" href="../../assets/css/navigation.css">
    <link rel="stylesheet" href="../../assets/css/modals.css">
    <link rel="stylesheet" href="../../assets/css/containers.css">
    <link rel="stylesheet" href="../../assets/css/dash.css">
    <link rel="stylesheet" href="../../assets/css/modern-enhancements.css">
    
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">

</head>
<body>
    <!-- Dashboard Loading Screen -->
    <div id="dashboardLoader" class="dashboard-loader">
        <div class="loader-content">
            <div class="dual-spinner-container">
                <div class="spinner-outer"></div>
                <div class="spinner-inner"></div>
            </div>
            <h3 class="loader-title">Đang tải Dashboard...</h3>
            <p class="loader-subtitle">Vui lòng đợi trong giây lát</p>
            <div class="loader-progress">
                <div class="progress-bar"></div>
            </div>
        </div>
        <div class="loader-background">
            <div class="floating-particles">
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
            </div>
        </div>
    </div>

    <!-- Modern Dashboard Application Container -->
    <div id="dashboardContent" class="dashboard-content modern-layout">

    <!-- Mobile Navigation Dialog - GitHub Style -->
    <dialog id="mobile-nav-dialog" class="mobile-nav-dialog modern-mobile-nav">
        <div class="mobile-nav-content">
            <div class="mobile-nav-header">
                <h2>Menu</h2>
                <button type="button" class="close-dialog" aria-label="Close navigation">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
            <nav class="mobile-nav" role="navigation" aria-label="Main mobile navigation">
                <ul id="mobileMenuList" class="mobile-menu-list">
                    <li class="mobile-menu-item" data-role="SUPER_ADMIN,ADMIN,STORE_MANAGER,EMPLOYEE,AD,QL,NV">
                        <a href="#" id="mobileWorkManagement" class="mobile-menu-link">
                            <span class="material-icons-round">schedule</span>
                            Quản Lý Công
                        </a>
                        <ul class="mobile-submenu">
                            <li class="mobile-submenu-item" data-role="SUPER_ADMIN,ADMIN,AREA_MANAGER,STORE_MANAGER,EMPLOYEE,AD,AM,QL,NV">
                                <a href="#" id="mobileTimesheet" class="mobile-submenu-link">
                                    <span class="material-icons-round">calendar_view_month</span>
                                    Bảng Công
                                </a>
                            </li>
                            <li class="mobile-submenu-item" data-role="SUPER_ADMIN,ADMIN,AREA_MANAGER,STORE_MANAGER,EMPLOYEE,AD,AM,QL,NV">
                                <a href="#" id="mobileAttendance" class="mobile-submenu-link">
                                    <span class="material-icons-round">location_on</span>
                                    Chấm Công
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="mobile-menu-item" data-role="SUPER_ADMIN,ADMIN,AREA_MANAGER,STORE_MANAGER,EMPLOYEE,AD,AM,QL,NV">
                        <a href="#" id="mobileWorkTasks" class="mobile-menu-link">Công Việc</a>
                    </li>
                    <li class="mobile-menu-item" data-role="SUPER_ADMIN,ADMIN,EMPLOYEE,AD,NV">
                        <a href="#" id="mobileSubmitRequest" class="mobile-menu-link">
                            <span class="material-icons-round">send</span>
                            Gửi Yêu Cầu
                        </a>
                        <ul class="mobile-submenu">
                            <li class="mobile-submenu-item" data-role="SUPER_ADMIN,ADMIN,EMPLOYEE,AD,NV">
                                <a href="#" id="mobileAttendanceRequest" class="mobile-submenu-link">
                                    <span class="material-icons-round">assignment</span>
                                    Đơn Từ
                                </a>
                            </li>
                            <li class="mobile-submenu-item" data-role="SUPER_ADMIN,ADMIN,EMPLOYEE,AD,NV">
                                <a href="#" id="mobileTaskAssignment" class="mobile-submenu-link">
                                    <span class="material-icons-round">task_alt</span>
                                    Nhiệm Vụ
                                </a>
                            </li>
                            <li class="mobile-submenu-item" data-role="SUPER_ADMIN,ADMIN,AREA_MANAGER,STORE_MANAGER,AD,AM,QL">
                                <a href="#" id="mobileShiftAssignment" class="mobile-submenu-link">
                                    <span class="material-icons-round">schedule_send</span>
                                    Phân Ca
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="mobile-menu-item" data-role="SUPER_ADMIN,ADMIN,STORE_MANAGER,AD,QL">
                        <a href="#" id="mobileTaskProcessing" class="mobile-menu-link">Xử Lý Yêu Cầu</a>
                        <ul class="mobile-submenu">
                            <li class="mobile-submenu-item" data-role="SUPER_ADMIN,ADMIN,AD">
                                <a href="#" id="mobileTaskPersonnel" class="mobile-submenu-link">Nhân Sự</a>
                            </li>
                            <li class="mobile-submenu-item" data-role="SUPER_ADMIN,ADMIN,STORE_MANAGER,AD,QL">
                                <a href="#" id="mobileTaskStore" class="mobile-submenu-link">Cửa Hàng</a>
                            </li>
                            <li class="mobile-submenu-item" data-role="SUPER_ADMIN,ADMIN,AD">
                                <a href="#" id="mobileTaskFinance" class="mobile-submenu-link">Tài Chính</a>
                            </li>
                            <li class="mobile-submenu-item" data-role="SUPER_ADMIN,ADMIN,STORE_MANAGER,AD,QL">
                                <a href="#" id="mobileTaskApproval" class="mobile-submenu-link">Xét Duyệt</a>
                            </li>
                        </ul>
                    </li>
                    <li class="mobile-menu-item" data-role="SUPER_ADMIN,ADMIN,STORE_MANAGER,AD,QL">
                        <a href="#" id="mobileRegistrationApproval" class="mobile-menu-link">Duyệt Đăng Ký</a>
                    </li>
                    <li class="mobile-menu-item" data-role="SUPER_ADMIN,ADMIN,AD">
                        <a href="#" id="mobileGrantAccess" class="mobile-menu-link">Phân Quyền</a>
                    </li>
                    <li class="mobile-menu-item" data-role="SUPER_ADMIN,ADMIN,STORE_MANAGER,AREA_MANAGER,EMPLOYEE,AD,QL,AM,NV">
                        <a href="#" id="mobilePersonalInformation" class="mobile-menu-link">Thông Tin Cá Nhân</a>
                    </li>
                </ul>
                <div class="mobile-nav-footer">
                    <button id="mobileLogout" class="mobile-logout-btn">
                        <span class="material-icons-round">logout</span>
                        Đăng xuất
                    </button>
                </div>
            </nav>
        </div>
    </dialog>

    <!-- Mobile Sidebar Overlay -->
    <div id="sidebarOverlay" class="app-sidebar-overlay"></div>

    <!-- User Info Header - GitHub AppHeader Style -->
    <div class="app-header">
        <!-- Professional Mobile Menu Toggle -->
        <button id="menuToggle" class="menu-toggle professional-toggle" aria-label="Toggle navigation" data-target="mobile-nav-dialog">
            <div class="toggle-icon">
                <span class="toggle-line line-1"></span>
                <span class="toggle-line line-2"></span>
                <span class="toggle-line line-3"></span>
            </div>
            <span class="toggle-text">Menu</span>
        </button>
        
        <div class="AppHeader-context">
            <div class="company-logo">
                <h1><a href="#" id="companyLogoLink" class="AppHeader-logo" style="text-decoration: none; color: inherit; cursor: pointer;">
                    <span class="company-name-desktop">ZewK Management System</span>
                    <span class="company-name-mobile">ZewK</span>
                </a></h1>
            </div>
        </div>
        <div class="AppHeader-actions">
            <!-- Notifications -->
            <div class="AppHeader-notifications">
                <button id="notificationToggle" class="notification-toggle" aria-label="Thông báo">
                    <span class="material-icons-round">notifications</span>
                    <span id="notificationBadge" class="notification-badge">3</span>
                </button>
                
                <!-- Notification Dropdown -->
                <div id="notificationDropdown" class="notification-dropdown">
                    <div class="notification-header">
                        <h3>Thông báo</h3>
                        <button id="markAllRead" class="mark-all-read">Đánh dấu đã đọc</button>
                    </div>
                    <div class="notification-list" id="notificationList">
                        <!-- Notifications will be populated here -->
                    </div>
                    <div class="notification-footer">
                        <a href="#" id="viewAllNotifications">Xem tất cả thông báo</a>
                    </div>
                </div>
            </div>
            
            <div class="AppHeader-user">
                <div id="userInfo" class="user-info"></div>
                <div id="currentTime" class="current-time">
                    <span id="timeIcon" class="time-icon material-icons-round">wb_sunny</span>
                    <span id="timeDisplay" class="time-display">00:00</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Sidebar -->
    <div class="app-sidebar">
        <ul id="menuList" class="menu-list">
            <li class="menu-item" data-role="SUPER_ADMIN,ADMIN,STORE_MANAGER,EMPLOYEE,AD,QL,NV">
                <a href="#" id="openWorkManagement" class="menu-link">
                    <span class="material-icons-round">schedule</span>
                    Quản Lý Công
                </a>
                <ul class="submenu">
                    <li class="submenu-item" data-role="SUPER_ADMIN,ADMIN,AREA_MANAGER,STORE_MANAGER,EMPLOYEE,AD,AM,QL,NV">
                        <a href="#" id="openTimesheet" class="submenu-link">
                            <span class="material-icons-round">calendar_view_month</span>
                            Bảng Công
                        </a>
                    </li>
                    <li class="submenu-item" data-role="SUPER_ADMIN,ADMIN,AREA_MANAGER,STORE_MANAGER,EMPLOYEE,AD,AM,QL,NV">
                        <a href="#" id="openAttendance" class="submenu-link">
                            <span class="material-icons-round">location_on</span>
                            Chấm Công
                        </a>
                    </li>
                </ul>
            </li>
            <li class="menu-item" data-role="SUPER_ADMIN,ADMIN,AREA_MANAGER,STORE_MANAGER,EMPLOYEE,AD,AM,QL,NV">
                <a href="#" id="openWorkTasks" class="menu-link">
                    <span class="material-icons-round">work</span>
                    Công Việc
                </a>
            </li>
            <li class="menu-item" data-role="SUPER_ADMIN,ADMIN,EMPLOYEE,AD,NV">
                <a href="#" id="openSubmitRequest" class="menu-link">
                    <span class="material-icons-round">send</span>
                    Gửi Yêu Cầu
                </a>
                <ul class="submenu">
                    <li class="submenu-item" data-role="SUPER_ADMIN,ADMIN,EMPLOYEE,AD,NV">
                        <a href="#" id="openAttendanceRequest" class="submenu-link">
                            <span class="material-icons-round">assignment</span>
                            Đơn Từ
                        </a>
                    </li>
                    <li class="submenu-item" data-role="SUPER_ADMIN,ADMIN,EMPLOYEE,AD,NV">
                        <a href="#" id="openTaskAssignment" class="submenu-link">
                            <span class="material-icons-round">task_alt</span>
                            Nhiệm Vụ
                        </a>
                    </li>
                    <li class="submenu-item" data-role="SUPER_ADMIN,ADMIN,AREA_MANAGER,STORE_MANAGER,AD,AM,QL">
                        <a href="#" id="openShiftAssignment" class="submenu-link">
                            <span class="material-icons-round">schedule_send</span>
                            Phân Ca
                        </a>
                    </li>
                </ul>
            </li>
            <li class="menu-item" data-role="SUPER_ADMIN,ADMIN,STORE_MANAGER,AREA_MANAGER,AD,QL,AM">
                <a href="#" id="openTaskProcessing" class="menu-link">Xử Lý Yêu Cầu</a>
                <ul class="submenu">
                    <li class="submenu-item" data-role="SUPER_ADMIN,ADMIN,STORE_MANAGER,AD,QL">
                        <a href="#" id="taskPersonnel" class="submenu-link">Nhân Sự</a>
                    </li>
                    <li class="submenu-item" data-role="SUPER_ADMIN,ADMIN,AREA_MANAGER,AD,AM">
                        <a href="#" id="taskStore" class="submenu-link">Cửa Hàng</a>
                    </li>
                    <li class="submenu-item" data-role="SUPER_ADMIN,ADMIN,AD">
                        <a href="#" id="taskFinance" class="submenu-link">Tài Chính</a>
                    </li>
                    <li class="submenu-item" data-role="SUPER_ADMIN,ADMIN,STORE_MANAGER,AD,QL">
                        <a href="#" id="taskApproval" class="submenu-link">Xét Duyệt</a>
                    </li>
                </ul>
            </li>
            <li class="menu-item" data-role="SUPER_ADMIN,ADMIN,STORE_MANAGER,AD,QL">
                <a href="#" id="openRegistrationApproval" class="menu-link">Duyệt Đăng Ký</a>
            </li>
            <li class="menu-item" data-role="SUPER_ADMIN,ADMIN,AD">
                <a href="#" id="openGrantAccess" class="menu-link">Phân Quyền</a>
            </li>
            <li class="menu-item" data-role="SUPER_ADMIN,ADMIN,STORE_MANAGER,AREA_MANAGER,EMPLOYEE,AD,QL,AM,NV">
                <a href="#" id="openPersonalInformation" class="menu-link">Thông Tin Cá Nhân</a>
            </li>
        </ul>
        <button id="logout" class="logout-btn">Đăng xuất</button>
    </div>

    <!-- Enhanced Loading Screen -->
    <div id="loadingScreen" class="loading-screen hidden">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <h2 class="loading-text">Đang tải hệ thống HR</h2>
            <p style="color: var(--text-secondary); font-size: 0.95rem; margin-bottom: 0;">Vui lòng chờ trong giây lát</p>
            <div class="loading-dots">
                <span class="loading-dot"></span>
                <span class="loading-dot"></span>
                <span class="loading-dot"></span>
            </div>
        </div>
    </div>

    <!-- Enhanced Main Content Area with Modern Layout -->
    <main class="main dashboard-main-fade-in modern-main-layout" role="main" aria-label="Dashboard main content">
        <!-- Global notification container -->
        <div id="notification" class="notification hidden" role="alert" aria-live="polite"></div>
        
        <!-- Dynamic content area with modern grid layout -->
        <div id="content" class="content modern-content-grid">
            <header class="dashboard-header">
                <h1 class="dashboard-title modern-title">Hệ Thống Quản Lý Nhân Sự</h1>
                <div class="dashboard-breadcrumb" aria-label="Breadcrumb navigation">
                    <span class="breadcrumb-item active">Dashboard</span>
                </div>
            </header>
            
            <!-- Enhanced Dashboard Overview -->
            <div class="welcome-section">
                <!-- Main Statistics Grid -->
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-icon">👥</div>
                        <div class="stat-info">
                            <h3>Tổng Nhân Viên</h3>
                            <p id="totalEmployees">-</p>
                            <span class="stat-trend">+2 tuần này</span>
                        </div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-icon">📅</div>
                        <div class="stat-info">
                            <h3>Ca Hôm Nay</h3>
                            <p id="todayShift">-</p>
                            <span class="stat-trend" id="todayShiftTime">-</span>
                        </div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-icon">📋</div>
                        <div class="stat-info">
                            <h3>Yêu Cầu Chờ</h3>
                            <p id="pendingRequests">-</p>
                            <span class="stat-trend">Cần xử lý</span>
                        </div>
                    </div>
                    <div class="stat-card info">
                        <div class="stat-icon">💬</div>
                        <div class="stat-info">
                            <h3>Tin Nhắn Mới</h3>
                            <p id="recentMessages">-</p>
                            <span class="stat-trend">24h qua</span>
                        </div>
                    </div>
                </div>

                <!-- Role-based Quick Actions -->
                <div class="quick-actions-section">
                    <h2 class="section-title">Thao Tác Nhanh</h2>
                    <div class="quick-actions-grid">
                        <button class="quick-action-btn" data-action="addEmployee">
                            <span class="action-icon">👤</span>
                            <span class="action-text">Thêm Nhân Viên</span>
                        </button>
                        <button class="quick-action-btn" data-action="assignShift">
                            <span class="action-icon">📊</span>
                            <span class="action-text">Phân Ca</span>
                        </button>
                        <button class="quick-action-btn" data-action="manageRewards">
                            <span class="action-icon">🏆</span>
                            <span class="action-text">Quản Lý Thưởng</span>
                        </button>
                        <button class="quick-action-btn" data-action="viewReports">
                            <span class="action-icon">📈</span>
                            <span class="action-text">Báo Cáo</span>
                        </button>
                    </div>
                </div>

                <!-- Advanced Analytics Dashboard for Admin -->
                <div class="analytics-section">
                    <h2 class="section-title">Phân Tích Dữ Liệu</h2>
                    <div class="analytics-grid">
                        <div class="chart-card">
                            <h3>Hiệu Suất Nhân Viên</h3>
                            <div class="chart-placeholder" id="performanceChart">
                                <p>Đang tải biểu đồ...</p>
                            </div>
                        </div>
                        <div class="chart-card">
                            <h3>Lịch Làm Theo Tuần</h3>
                            <div class="chart-placeholder" id="scheduleChart">
                                <p>Đang tải biểu đồ...</p>
                            </div>
                        </div>
                        <div class="chart-card">
                            <h3>Thưởng/Phạt</h3>
                            <div class="chart-placeholder" id="rewardsChart">
                                <p>Đang tải biểu đồ...</p>
                            </div>
                        </div>
                        <div class="chart-card">
                            <h3>Doanh Thu</h3>
                            <div class="chart-placeholder" id="revenueChart">
                                <p>Đang tải biểu đồ...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Store Management for Managers -->
                <div class="store-management-section">
                    <h2 class="section-title">Quản Lý Cửa Hàng</h2>
                    <div class="store-grid">
                        <div class="store-card" data-store="ST001">
                            <div class="store-header">
                                <h3>Cửa Hàng Trung Tâm</h3>
                                <span class="store-status active">Hoạt động</span>
                            </div>
                            <div class="store-stats">
                                <div class="store-stat">
                                    <span class="stat-label">Nhân viên:</span>
                                    <span class="stat-value" id="store1Employees">-</span>
                                </div>
                                <div class="store-stat">
                                    <span class="stat-label">Ca làm hôm nay:</span>
                                    <span class="stat-value" id="store1Shift">-</span>
                                </div>
                            </div>
                            <div class="store-actions">
                                <button class="btn-sm btn-primary" onclick="manageStore('ST001')">Quản Lý</button>
                                <button class="btn-sm btn-outline" onclick="viewStoreShifts('ST001')">Xem Ca</button>
                            </div>
                        </div>
                        <div class="store-card" data-store="ST002">
                            <div class="store-header">
                                <h3>Cửa Hàng Quận 1</h3>
                                <span class="store-status active">Hoạt động</span>
                            </div>
                            <div class="store-stats">
                                <div class="store-stat">
                                    <span class="stat-label">Nhân viên:</span>
                                    <span class="stat-value" id="store2Employees">-</span>
                                </div>
                                <div class="store-stat">
                                    <span class="stat-label">Ca làm hôm nay:</span>
                                    <span class="stat-value" id="store2Shift">-</span>
                                </div>
                            </div>
                            <div class="store-actions">
                                <button class="btn-sm btn-primary" onclick="manageStore('ST002')">Quản Lý</button>
                                <button class="btn-sm btn-outline" onclick="viewStoreShifts('ST002')">Xem Ca</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activities -->
                <div class="activities-section">
                    <h2 class="section-title">Hoạt Động Gần Đây</h2>
                    <div class="activities-container">
                        <div id="recentActivities" class="activities-list">
                            <p class="loading-text">Đang tải hoạt động...</p>
                        </div>
                        <div class="activities-footer">
                            <button class="btn-outline" onclick="loadMoreActivities()">Xem thêm</button>
                        </div>
                    </div>
                </div>

                <!-- Finance Overview for Admin -->
                <div class="finance-section">
                    <h2 class="section-title">Tổng Quan Tài Chính</h2>
                    <div class="finance-grid">
                        <div class="finance-card revenue">
                            <div class="finance-header">
                                <h3>Doanh Thu Tháng</h3>
                                <span class="finance-trend up">↗ +12%</span>
                            </div>
                            <div class="finance-amount" id="monthlyRevenue">0 ₫</div>
                            <div class="finance-subtitle">So với tháng trước</div>
                        </div>
                        <div class="finance-card expense">
                            <div class="finance-header">
                                <h3>Chi Phí Tháng</h3>
                                <span class="finance-trend down">↘ -5%</span>
                            </div>
                            <div class="finance-amount" id="monthlyExpense">0 ₫</div>
                            <div class="finance-subtitle">Tiết kiệm được</div>
                        </div>
                        <div class="finance-card profit">
                            <div class="finance-header">
                                <h3>Lợi Nhuận</h3>
                                <span class="finance-trend up">↗ +18%</span>
                            </div>
                            <div class="finance-amount" id="monthlyProfit">0 ₫</div>
                            <div class="finance-subtitle">Tăng trưởng tốt</div>
                        </div>
                        <div class="finance-card payroll">
                            <div class="finance-header">
                                <h3>Lương Nhân Viên</h3>
                                <span class="finance-trend neutral">→ 0%</span>
                            </div>
                            <div class="finance-amount" id="monthlyPayroll">0 ₫</div>
                            <div class="finance-subtitle">Ổn định</div>
                        </div>
                    </div>
                </div>

                <!-- Registration Approval for Admin and Managers -->
                <div class="registration-approval-section">
                    <h2 class="section-title">Duyệt Đăng Ký Nhân Viên</h2>
                    <div class="approval-container">
                        <div class="approval-header">
                            <div class="approval-filters">
                                <select id="storeFilter" class="filter-select">
                                    <option value="">Tất cả cửa hàng</option>
                                </select>
                                <button id="refreshPendingBtn" class="refresh-btn">
                                    <span class="material-icons-round">refresh</span>
                                    Làm mới
                                </button>
                            </div>
                        </div>
                        <div id="pendingRegistrationsList" class="registrations-list">
                            <p class="loading-text">Đang tải danh sách...</p>
                        </div>
                    </div>
                </div>

                <!-- Personal Dashboard for Employees -->
                <div class="personal-section">
                    <h2 class="section-title">Thông Tin Cá Nhân</h2>
                    <div class="personal-grid">
                        <div class="personal-card schedule">
                            <h3>Ca Làm Tuần Này</h3>
                            <div id="personalShifts" class="shift-preview">
                                <p>Đang tải ca làm...</p>
                            </div>
                        </div>
                        <div class="personal-card rewards">
                            <h3>Thưởng/Phạt Gần Đây</h3>
                            <div id="personalRewards" class="rewards-preview">
                                <p>Đang tải thông tin...</p>
                            </div>
                        </div>
                        <div class="personal-card tasks">
                            <h3>Yêu Cầu Của Tôi</h3>
                            <div id="personalTasks" class="tasks-preview">
                                <p>Đang tải yêu cầu...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Load JavaScript modules in correct order -->
    <script src="../../assets/js/config.js"></script>
    <script src="../../assets/js/utils.js"></script>
    <script src="../../assets/js/auth-manager.js"></script>
    <script src="../../assets/js/theme-manager.js"></script>
    <script src="../../assets/js/menu-manager.js"></script>
    <script src="../../assets/js/content-manager.js"></script>
    <script src="../../assets/js/dashboard-handler.js"></script>
    <script src="../../assets/js/notification-chat-manager.js"></script>
    <script src="../../assets/js/script.js"></script>
    <script src="../../assets/js/main-init.js"></script>
    </div> <!-- End dashboardContent -->

    <!-- Chat System - Moved outside dashboardContent for better isolation -->
    <div id="chatSystem" class="chat-system">
        <!-- Chat Toggle Button -->
        <button id="chatToggle" class="chat-toggle" aria-label="Mở chat">
            <span class="material-icons-round">chat</span>
            <span id="chatNotificationBadge" class="chat-notification-badge">2</span>
        </button>
        
        <!-- Chat Panel -->
        <div id="chatPanel" class="chat-panel">
            <div class="chat-header">
                <div class="chat-title">
                    <h3>Hệ thống Chat</h3>
                </div>
                <div class="chat-controls">
                    <button id="minimizeChat" class="chat-control" aria-label="Thu nhỏ">
                        <span class="material-icons-round">minimize</span>
                    </button>
                    <button id="closeChat" class="chat-control" aria-label="Đóng">
                        <span class="material-icons-round">close</span>
                    </button>
                </div>
            </div>
            
            <!-- Chat Tabs -->
            <div class="chat-tabs">
                <button class="chat-tab active" data-chat-type="general">
                    <span class="material-icons-round">public</span>
                    Tổng
                </button>
                <button class="chat-tab" data-chat-type="department">
                    <span class="material-icons-round">domain</span>
                    Phòng ban
                </button>
                <button class="chat-tab" data-chat-type="private">
                    <span class="material-icons-round">person</span>
                    Riêng tư
                </button>
                <button class="chat-tab" data-chat-type="group">
                    <span class="material-icons-round">group</span>
                    Nhóm
                </button>
            </div>
            
            <!-- Chat Content -->
            <div class="chat-content">
                <!-- General Chat -->
                <div class="chat-room active" data-room="general">
                    <div class="chat-messages" id="generalMessages">
                        <div class="message-day">Hôm nay</div>
                        <!-- Messages will be populated here -->
                    </div>
                    <div class="chat-input-container">
                        <div class="chat-input-wrapper">
                            <input type="text" class="chat-input" placeholder="Nhập tin nhắn..." data-room="general">
                            <button class="chat-send" data-room="general">
                                <span class="material-icons-round">send</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Department Chat -->
                <div class="chat-room" data-room="department">
                    <div class="department-selector">
                        <select id="departmentSelect" class="department-select">
                            <option value="">Chọn phòng ban</option>
                            <!-- Will be populated dynamically -->
                        </select>
                    </div>
                    <div class="chat-messages" id="departmentMessages">
                        <div class="empty-chat">Chọn phòng ban để bắt đầu trò chuyện</div>
                    </div>
                    <div class="chat-input-container">
                        <div class="chat-input-wrapper">
                            <input type="text" class="chat-input" placeholder="Nhập tin nhắn..." data-room="department" disabled>
                            <button class="chat-send" data-room="department" disabled>
                                <span class="material-icons-round">send</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Private Chat -->
                <div class="chat-room" data-room="private">
                    <div class="private-chat-sidebar">
                        <div class="private-chat-search">
                            <input type="text" id="userSearch" placeholder="Tìm nhân viên..." class="user-search">
                        </div>
                        <div class="private-chat-list" id="privateChatList">
                            <!-- Will be populated with user conversations -->
                        </div>
                    </div>
                    <div class="private-chat-main">
                        <div class="private-chat-header" id="privateChatHeader">
                            <div class="empty-chat">Chọn người để bắt đầu trò chuyện</div>
                        </div>
                        <div class="chat-messages" id="privateMessages">
                            <div class="empty-chat">Chọn cuộc trò chuyện từ danh sách bên trái</div>
                        </div>
                        <div class="chat-input-container">
                            <div class="chat-input-wrapper">
                                <input type="text" class="chat-input" placeholder="Nhập tin nhắn..." data-room="private" disabled>
                                <button class="chat-send" data-room="private" disabled>
                                    <span class="material-icons-round">send</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Group Chat -->
                <div class="chat-room" data-room="group">
                    <div class="group-chat-header">
                        <button id="createGroupBtn" class="create-group-btn">
                            <span class="material-icons-round">add</span>
                            Tạo nhóm mới
                        </button>
                    </div>
                    <div class="group-list" id="groupList">
                        <!-- Will be populated with groups -->
                    </div>
                    <div class="chat-messages" id="groupMessages">
                        <div class="empty-chat">Chọn nhóm để bắt đầu trò chuyện</div>
                    </div>
                    <div class="chat-input-container">
                        <div class="chat-input-wrapper">
                            <input type="text" class="chat-input" placeholder="Nhập tin nhắn..." data-room="group" disabled>
                            <button class="chat-send" data-room="group" disabled>
                                <span class="material-icons-round">send</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Group Modal -->
    <div id="createGroupModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Tạo nhóm chat mới</h3>
                <button class="modal-close" data-modal="createGroupModal">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="groupName">Tên nhóm</label>
                    <input type="text" id="groupName" class="form-input" placeholder="Nhập tên nhóm">
                </div>
                <div class="form-group">
                    <label for="groupDescription">Mô tả (tùy chọn)</label>
                    <textarea id="groupDescription" class="form-textarea" placeholder="Mô tả về nhóm"></textarea>
                </div>
                <div class="form-group">
                    <label>Thành viên</label>
                    <div class="member-selection" id="memberSelection">
                        <!-- Will be populated with employee list -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-modal="createGroupModal">Hủy</button>
                <button type="button" id="createGroupConfirm" class="btn btn-primary">Tạo nhóm</button>
            </div>
        </div>
    </div>

</body>
</html>
