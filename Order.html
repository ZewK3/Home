<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Order ToCoToCo - Lạc Long Quân</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="header">
    <button class="menu-toggle" onclick="toggleMenu()">☰</button>
    <div class="user-info" id="user-info" style="display: none;">
      <div class="user-name">
        <span id="user-name-display"></span>
        <span class="rank-icon" id="rank-icon"></span>
      </div>
      <div class="points-exp">
        <div class="points" id="user-points">0 Points</div>
        <div class="exp-bar"><div class="exp-fill" id="exp-fill" style="width: 0%"></div></div>
      </div>
    </div>
    <div id="auth-control">
      <button onclick="showLoginPopup(false)" id="login-button">Đăng nhập</button>
      <button onclick="showLoginPopup(true)" id="register-button">Đăng ký</button>
      <button onclick="logout()" id="logout-button" style="display: none;">Đăng xuất</button>
    </div>
  </div>
  <div class="container">
    <div class="sidebar" id="sidebar">
      <div>
        <h3>Danh Mục</h3>
        <ul id="category-list"></ul>
      </div>
      <div class="cart" onclick="viewCart()">
        Giỏ hàng (<span id="cart-count">0</span>)
      </div>
    </div>
    <div class="content" id="product-list"></div>
  </div>

  <!-- Popup chọn tùy chọn -->
  <div class="popup" id="popup">
    <div class="popup-content">
      <button class="close-btn" onclick="closePopup()">×</button>
      <h3 id="popup-title">Chọn tùy chọn</h3>
      <p class="product-name" id="popup-product-name"></p>
      
      <div class="option-row" id="size-section">
        <label>Size:</label>
        <div id="size-options" class="checkbox-group"></div>
      </div>
      <div class="option-row" id="topping-section">
        <label>Topping:</label>
        <div id="topping-options" class="checkbox-group vertical"></div>
      </div>
      <div class="option-row" id="sugar-section">
        <label>Mức đường:</label>
        <div id="sugar-options" class="checkbox-group"></div>
      </div>
      <div class="option-row" id="ice-section">
        <label>Mức đá:</label>
        <div id="ice-options" class="checkbox-group"></div>
      </div>
      <div class="quantity-group">
        <label>Số lượng:</label>
        <input type="number" id="quantity-input" min="1" value="1">
      </div>
      <div class="note-group">
        <label>Ghi chú:</label>
        <textarea id="note-input" placeholder="Nhập ghi chú (nếu có)"></textarea>
      </div>
      
      <button id="popup-action-btn" onclick="addToCart()">Thêm vào giỏ</button>
    </div>
  </div>

  <!-- Popup giỏ hàng và lịch sử -->
  <div class="cart-popup" id="cart-popup">
    <div class="cart-content">
      <button class="close-btn" onclick="closeCart()">×</button>
      <div class="tabs">
        <button class="tab-button active" onclick="showCartTab()">Giỏ hàng</button>
        <button class="tab-button" onclick="showHistoryTab()">Lịch sử đơn hàng</button>
      </div>
      <div id="cart-tab" class="tab-content">
        <h3>Giỏ hàng</h3>
        <ul id="cart-items"></ul>
        <div class="total" id="cart-total">Tổng cộng: 0 VNĐ</div>
        <button id="checkout-btn" onclick="placeOrder()">Đặt hàng</button>
      </div>
      <div id="history-tab" class="tab-content" style="display: none;">
        <h3>Lịch sử đơn hàng</h3>
        <ul id="history-items"></ul>
      </div>
    </div>
  </div>

  <!-- Popup phóng to sản phẩm -->
  <div class="zoom-popup" id="zoom-popup">
    <div class="zoom-content">
      <button class="close-btn" onclick="closeZoomPopup()">×</button>
      <img id="zoom-image" src="" alt="Product Image">
      <h3 id="zoom-product-name"></h3>
      <p id="zoom-product-price"></p>
    </div>
  </div>

  <!-- Popup đăng nhập/đăng ký -->
  <div id="auth-popup" onclick="hidePopup(event)">
    <div class="auth-box" onclick="event.stopPropagation()">
      <h3 id="auth-title">Đăng nhập</h3>
      <input id="user-name" placeholder="Tên của bạn" style="display:none;">
      <input id="user-email" placeholder="Email/SĐT">
      <input id="user-password" type="password" placeholder="Mật khẩu">
      <button onclick="submitAuth()">Tiếp tục</button>
    </div>
  </div>

  <!-- Popup QR thanh toán -->
  <div class="qr-popup" id="qr-popup">
    <div class="qr-content">
      <button class="close-btn" onclick="cancelTransaction()">×</button>
      <h3>Thanh toán đơn hàng</h3>
      <img id="popup-qr-image" src="" alt="QR Code">
      <p id="qr-amount"></p>
      <p class="countdown" id="countdown"></p>
      <button id="pause-transaction">Treo giao dịch</button>
      <button id="cancel-transaction" onclick="cancelTransaction()">Hủy giao dịch</button>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>
